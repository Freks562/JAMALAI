generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

enum Branch {
  NAVY
  ARMY
  AIR_FORCE
  MARINES
  COAST_GUARD
  SPACE_FORCE
}

model Veteran {
  id         String          @id @default(cuid())
  name       String
  rank       String
  branch     Branch
  startYear  Int?
  endYear    Int?
  records    ServiceRecord[]
  createdAt  DateTime        @default(now())
  updatedAt  DateTime        @updatedAt
}

model Ship {
  id        String              @id @default(cuid())
  name      String              @unique
  createdAt DateTime            @default(now())
  updatedAt DateTime            @updatedAt
  ships     ServiceRecordShip[]
}

model ServiceRecord {
  id         String              @id @default(cuid())
  veteranId  String
  veteran    Veteran             @relation(fields: [veteranId], references: [id])
  unit       String
  branch     Branch
  startYear  Int?
  endYear    Int?
  ships      ServiceRecordShip[]
  createdAt  DateTime            @default(now())
  updatedAt  DateTime            @updatedAt
}

model ServiceRecordShip {
  id               String         @id @default(cuid())
  serviceRecordId  String
  serviceRecord    ServiceRecord  @relation(fields: [serviceRecordId], references: [id])
  shipId           String
  ship             Ship           @relation(fields: [shipId], references: [id])
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt

  @@unique([serviceRecordId, shipId])
}